"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[58720],{85162:(e,t,n)=>{n.d(t,{Z:()=>r});var a=n(67294),i=n(86010);const s={tabItem:"tabItem_Ymn6"};function r(e){let{children:t,hidden:n,className:r}=e;return a.createElement("div",{role:"tabpanel",className:(0,i.Z)(s.tabItem,r),hidden:n},t)}},74866:(e,t,n)=>{n.d(t,{Z:()=>b});var a=n(87462),i=n(67294),s=n(86010),r=n(12466),o=n(16550),l=n(91980),u=n(67392),p=n(50012);function d(e){return function(e){return i.Children.map(e,(e=>{if(!e||(0,i.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}(e).map((e=>{let{props:{value:t,label:n,attributes:a,default:i}}=e;return{value:t,label:n,attributes:a,default:i}}))}function c(e){const{values:t,children:n}=e;return(0,i.useMemo)((()=>{const e=t??d(n);return function(e){const t=(0,u.l)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function m(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function h(e){let{queryString:t=!1,groupId:n}=e;const a=(0,o.k6)(),s=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,l._X)(s),(0,i.useCallback)((e=>{if(!s)return;const t=new URLSearchParams(a.location.search);t.set(s,e),a.replace({...a.location,search:t.toString()})}),[s,a])]}function f(e){const{defaultValue:t,queryString:n=!1,groupId:a}=e,s=c(e),[r,o]=(0,i.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!m({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const a=n.find((e=>e.default))??n[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:t,tabValues:s}))),[l,u]=h({queryString:n,groupId:a}),[d,f]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[a,s]=(0,p.Nk)(n);return[a,(0,i.useCallback)((e=>{n&&s.set(e)}),[n,s])]}({groupId:a}),k=(()=>{const e=l??d;return m({value:e,tabValues:s})?e:null})();(0,i.useLayoutEffect)((()=>{k&&o(k)}),[k]);return{selectedValue:r,selectValue:(0,i.useCallback)((e=>{if(!m({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);o(e),u(e),f(e)}),[u,f,s]),tabValues:s}}var k=n(72389);const g={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function y(e){let{className:t,block:n,selectedValue:o,selectValue:l,tabValues:u}=e;const p=[],{blockElementScrollPositionUntilNextRender:d}=(0,r.o5)(),c=e=>{const t=e.currentTarget,n=p.indexOf(t),a=u[n].value;a!==o&&(d(t),l(a))},m=e=>{let t=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const n=p.indexOf(e.currentTarget)+1;t=p[n]??p[0];break}case"ArrowLeft":{const n=p.indexOf(e.currentTarget)-1;t=p[n]??p[p.length-1];break}}t?.focus()};return i.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.Z)("tabs",{"tabs--block":n},t)},u.map((e=>{let{value:t,label:n,attributes:r}=e;return i.createElement("li",(0,a.Z)({role:"tab",tabIndex:o===t?0:-1,"aria-selected":o===t,key:t,ref:e=>p.push(e),onKeyDown:m,onClick:c},r,{className:(0,s.Z)("tabs__item",g.tabItem,r?.className,{"tabs__item--active":o===t})}),n??t)})))}function v(e){let{lazy:t,children:n,selectedValue:a}=e;const s=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){const e=s.find((e=>e.props.value===a));return e?(0,i.cloneElement)(e,{className:"margin-top--md"}):null}return i.createElement("div",{className:"margin-top--md"},s.map(((e,t)=>(0,i.cloneElement)(e,{key:t,hidden:e.props.value!==a}))))}function w(e){const t=f(e);return i.createElement("div",{className:(0,s.Z)("tabs-container",g.tabList)},i.createElement(y,(0,a.Z)({},e,t)),i.createElement(v,(0,a.Z)({},e,t)))}function b(e){const t=(0,k.Z)();return i.createElement(w,(0,a.Z)({key:String(t)},e))}},46300:(e,t,n)=>{n.d(t,{Z:()=>s});var a=n(67294),i=n(50012);function s(e){let{path:t}=e;const[n]=(0,i.Nk)("docusaurus.tab.js-ts"),s=t.lastIndexOf("{"),r=t.slice(s+1,t.length-1),[o,l]=r.split(","),u=t.slice(0,s);return a.createElement("code",null,u+("js"===n?o:l))}},48863:(e,t,n)=>{n.d(t,{A:()=>r,v:()=>o});var a=n(67294),i=n(50012),s=n(49875);function r(e){let{children:t}=e;const[n]=(0,i.Nk)("docusaurus.tab.js-ts");return"ts"===n&&a.createElement(s.Z,null,t)}function o(e){let{children:t}=e;const[n]=(0,i.Nk)("docusaurus.tab.js-ts");return"js"===n&&a.createElement(s.Z,null,t)}},96112:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>u,default:()=>f,frontMatter:()=>l,metadata:()=>p,toc:()=>c});var a=n(87462),i=(n(67294),n(3905)),s=(n(46300),n(85162)),r=n(74866),o=n(48863);const l={title:"Entities"},u=void 0,p={unversionedId:"data-model/entities",id:"version-0.16.0/data-model/entities",title:"Entities",description:"Entities are the foundation of your app's data model. In short, an Entity defines a model in your database.",source:"@site/versioned_docs/version-0.16.0/data-model/entities.md",sourceDirName:"data-model",slug:"/data-model/entities",permalink:"/docs/data-model/entities",draft:!1,editUrl:"https://github.com/wasp-lang/wasp/edit/release/web/versioned_docs/version-0.16.0/data-model/entities.md",tags:[],version:"0.16.0",frontMatter:{title:"Entities"},sidebar:"docs",previous:{title:"7. Adding Authentication",permalink:"/docs/tutorial/auth"},next:{title:"Overview",permalink:"/docs/data-model/operations/overview"}},d={},c=[{value:"Defining an Entity",id:"defining-an-entity",level:2},{value:"Working with Entities",id:"working-with-entities",level:3},{value:"Using Entities in Operations",id:"using-entities-in-operations",level:4},{value:"Using Entities directly",id:"using-entities-directly",level:4},{value:"Next steps",id:"next-steps",level:3}],m={toc:c},h="wrapper";function f(e){let{components:t,...n}=e;return(0,i.kt)(h,(0,a.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Entities are the foundation of your app's data model. In short, an Entity defines a model in your database."),(0,i.kt)("p",null,"Wasp uses the excellent ",(0,i.kt)("a",{parentName:"p",href:"https://www.prisma.io/"},"Prisma ORM")," to implement all database functionality and occasionally enhances it with a thin abstraction layer. This means that you use the ",(0,i.kt)("inlineCode",{parentName:"p"},"schema.prisma")," file to define your database models and relationships. Wasp understands the Prisma schema file and picks up all the models you define there. You can read more about this in the ",(0,i.kt)("a",{parentName:"p",href:"/docs/data-model/prisma-file"},"Prisma Schema File")," section of the docs."),(0,i.kt)("p",null,"In your project, you'll find a ",(0,i.kt)("inlineCode",{parentName:"p"},"schema.prisma")," file in the root directory:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},".\n\u251c\u2500\u2500 main.wasp\n...\n\u251c\u2500\u2500 schema.prisma\n\u251c\u2500\u2500 src\n\u251c\u2500\u2500 tsconfig.json\n\u2514\u2500\u2500 vite.config.ts\n")),(0,i.kt)("p",null,"Prisma uses the ",(0,i.kt)("em",{parentName:"p"},"Prisma Schema Language"),", a simple definition language explicitly created for defining models.\nThe language is declarative and very intuitive. We'll also go through an example later in the text, so there's no need to go and thoroughly learn it right away. Still, if you're curious, look no further than Prisma's official documentation:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://www.prisma.io/docs/orm/prisma-schema/overview"},"Basic intro and examples")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"https://www.prisma.io/docs/orm/reference/prisma-schema-reference"},"A more exhaustive language specification"))),(0,i.kt)("h2",{id:"defining-an-entity"},"Defining an Entity"),(0,i.kt)("p",null,"A Prisma ",(0,i.kt)("inlineCode",{parentName:"p"},"model")," declaration in the ",(0,i.kt)("inlineCode",{parentName:"p"},"schema.prisma")," file represents a Wasp Entity."),(0,i.kt)("details",null,(0,i.kt)("summary",null,"Entity vs Model"),(0,i.kt)("p",null,"You might wonder why we distinguish between a ",(0,i.kt)("strong",{parentName:"p"},"Wasp Entity")," and a ",(0,i.kt)("strong",{parentName:"p"},"Prisma model")," if they're essentially the same thing right now. "),(0,i.kt)("p",null,"While defining a Prisma model is currently the only way to create an Entity in Wasp, the Entity concept is a higher-level abstraction. We plan to expand on Entities in the future, both in terms of how you can define them and what you can do with them."),(0,i.kt)("p",null,"So, think of an Entity as a Wasp concept and a model as a Prisma concept. For now, all Prisma models are Entities and vice versa, but this relationship might evolve as Wasp grows.")),(0,i.kt)("p",null,"Here's how you could define an Entity that represents a Task:"),(0,i.kt)(r.Z,{groupId:"js-ts",mdxType:"Tabs"},(0,i.kt)(s.Z,{value:"js",label:"JavaScript",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-prisma",metastring:'title="schema.prisma"',title:'"schema.prisma"'},"model Task {\n  id          String  @id @default(uuid())\n  description String\n  isDone      Boolean @default(false)\n}\n"))),(0,i.kt)(s.Z,{value:"ts",label:"TypeScript",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-prisma",metastring:'title="schema.prisma"',title:'"schema.prisma"'},"model Task {\n  id          String  @id @default(uuid())\n  description String\n  isDone      Boolean @default(false)\n}\n")))),(0,i.kt)("p",null,"The above Prisma ",(0,i.kt)("inlineCode",{parentName:"p"},"model")," definition tells Wasp to create a table for storing Tasks where each task has three fields (i.e., the ",(0,i.kt)("inlineCode",{parentName:"p"},"tasks")," table has three columns):"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"id")," - A string value serving as a primary key. The database automatically generates it by generating a random unique ID."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"description")," - A string value for storing the task's description."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"isDone")," - A boolean value indicating the task's completion status. If you don't set it when creating a new task, the database sets it to ",(0,i.kt)("inlineCode",{parentName:"li"},"false")," by default.")),(0,i.kt)(o.A,{mdxType:"ShowForTs"},(0,i.kt)("p",null,"Wasp also exposes a type for working with the created Entity. You can import and use it like this:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"import { Task } from 'wasp/entities'\n\nconst task: Task = { ... }\n\n// You can also define functions for working with entities\nfunction getInfoMessage(task: Task): string {\n  const isDoneText = task.isDone ? \"is done\" : \"is not done\"\n  return `Task '${task.description}' is ${isDoneText}.`\n}\n")),(0,i.kt)("p",null,"Using the ",(0,i.kt)("inlineCode",{parentName:"p"},"Task")," type in ",(0,i.kt)("inlineCode",{parentName:"p"},"getInfoMessageInfo"),"'s definition connects the argument's type with the ",(0,i.kt)("inlineCode",{parentName:"p"},"Task")," entity."),(0,i.kt)("p",null,"This coupling removes duplication and ensures the function keeps the correct signature even if you change the entity. Of course, the function might throw type errors depending on how you change it, but that's precisely what you want!"),(0,i.kt)("p",null,"Entity types are available everywhere, including the client code:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'import { Task } from "wasp/entities"\n\nexport function ExamplePage() {\n  const task: Task = {\n    id: 123,\n    description: "Some random task",\n    isDone: false,\n  }\n  return <div>{task.description}</div>\n}\n')),(0,i.kt)("p",null,"The mentioned type safety mechanisms also apply here: changing the task entity in our ",(0,i.kt)("inlineCode",{parentName:"p"},"schema.prisma")," file changes the imported type, which might throw a type error and warn us that our task definition is outdated."),(0,i.kt)("p",null,"You'll learn even more about Entity types when you start using ",(0,i.kt)("a",{parentName:"p",href:"#using-entities-in-operations"},"them with operations"),".")),(0,i.kt)("h3",{id:"working-with-entities"},"Working with Entities"),(0,i.kt)("p",null,"Let's see how you can define and work with Wasp Entities:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Create/update some Entities in the ",(0,i.kt)("inlineCode",{parentName:"li"},"schema.prisma")," file."),(0,i.kt)("li",{parentName:"ol"},"Run ",(0,i.kt)("inlineCode",{parentName:"li"},"wasp db migrate-dev"),". This command syncs the database model with the Entity definitions the ",(0,i.kt)("inlineCode",{parentName:"li"},"schema.prisma")," file. It does this by creating migration scripts."),(0,i.kt)("li",{parentName:"ol"},"Migration scripts are automatically placed in the ",(0,i.kt)("inlineCode",{parentName:"li"},"migrations/")," folder. Make sure to commit this folder into version control."),(0,i.kt)("li",{parentName:"ol"},"Use Wasp's JavasScript API to work with the database when implementing Operations (we'll cover this in detail when we talk about ",(0,i.kt)("a",{parentName:"li",href:"../data-model/operations/overview"},"operations"),").")),(0,i.kt)("h4",{id:"using-entities-in-operations"},"Using Entities in Operations"),(0,i.kt)("p",null,"Most of the time, you will be working with Entities within the context of ",(0,i.kt)("a",{parentName:"p",href:"../data-model/operations/overview"},"Operations (Queries & Actions)"),". We'll see how that's done on the next page."),(0,i.kt)("h4",{id:"using-entities-directly"},"Using Entities directly"),(0,i.kt)("p",null,"If you need more control, you can directly interact with Entities by importing and using the ",(0,i.kt)("a",{parentName:"p",href:"https://www.prisma.io/docs/concepts/components/prisma-client/crud"},"Prisma Client"),". We recommend sticking with conventional Wasp-provided mechanisms, only resorting to directly using the Prisma client only if you need a feature Wasp doesn't provide."),(0,i.kt)("p",null,"You can only use the Prisma Client in your Wasp server code. You can import it like this:"),(0,i.kt)(r.Z,{groupId:"js-ts",mdxType:"Tabs"},(0,i.kt)(s.Z,{value:"js",label:"JavaScript",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"import { prisma } from 'wasp/server'\n\nprisma.task.create({\n    description: \"Read the Entities doc\",\n    isDone: true // almost :)\n})\n"))),(0,i.kt)(s.Z,{value:"ts",label:"TypeScript",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"import { prisma } from 'wasp/server'\n\nprisma.task.create({\n    description: \"Read the Entities doc\",\n    isDone: true // almost :)\n})\n")))),(0,i.kt)("h3",{id:"next-steps"},"Next steps"),(0,i.kt)("p",null,"Now that we've seen how to define Entities that represent Wasp's core data model, we'll see how to make the most of them in other parts of Wasp. Keep reading to learn all about Wasp Operations!"))}f.isMDXComponent=!0}}]);